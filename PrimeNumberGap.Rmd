---
title: "PrimeNumberGap"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

Box Plot for Hypothesis (1)

```{r}
primeAux <- prime
primeAux$group <- as.numeric(cut2(primeAux$Input, g=15))
plot = ggplot(data= primeAux, aes(factor(group), prime$PrimeGap)) +
  geom_boxplot() + labs(x = "Random Number", y = "Prime Number Gap") 
plot
```

Density plot of the general distribution of the gaps between the prime numbers, usefull for hypothesis (2) since we have log(Random Number)
```{r}
smoothScatter(log(prime$Input),prime$PrimeGap,
             xlab="log(Random Number)",ylab="Prime Number Gap",main="Prime Number Gap Density")
```

```{r}
meanE <- mean(prime$PrimeGap)
std <- sd(prime$PrimeGap)
meanPlot <- ggplot(data= prime, aes(prime$PrimeGap, prime$Input)) + 
  geom_point() + labs(x = "Prime Number Gap", y = "Random Number") +
  geom_vline(aes(xintercept = meanE, colour = "mean")) + 
  geom_vline(aes(xintercept = (meanE + std), colour = "std"), linetype = "dashed") + 
  geom_vline(aes(xintercept = (meanE - std), colour = "std"), linetype = "dashed") + 
  geom_vline(aes(xintercept = median(prime$PrimeGap), 
                 colour = "median"), linetype = "dashed") + 
  geom_vline(aes(xintercept = quantile(prime$PrimeGap, 0.25), 
                 colour = "quantile25"), linetype = "dashed") +
  geom_vline(aes(xintercept = quantile(prime$PrimeGap, 0.75), 
                 colour = "quantile75"), linetype = "dashed") +
  scale_colour_manual(name = "Legend", 
                      breaks = c("mean", "std","median", "quantile25", "quantile75"), 
                      values= c(mean = "red", std = "blue", median = "orange", quantile25 = "green", quantile75 = "yellow"))
meanPlot
```

Pseudo-random distribution log(n) for hypothesis Random Number (2)
```{r}
lnPlot <- ggplot(data= prime, aes(log(prime$Input), prime$PrimeGap)) + 
  geom_point() + labs(x = "Random Number", y = "log(Prime Number Gap)") + geom_smooth(method = "lm")
lnPlot
```

Box Plot of overall average gap values
```{r}
plot = ggplot(data= prime, aes(prime$Input, prime$PrimeGap)) +
  geom_boxplot() + labs(x = "Random Number", y = "Prime Number Gap") 
plot
```

Scatter Plot of correlation between consecutive gaps, for Hypothesis (3) (As the graph show not much correlation)
```{r}
lnPlot <- ggplot(data= prime, aes(prime$PrimeGap, prime$NextGap)) + 
  geom_point() + labs(x = "Current Gap", y = "Next Gap") + geom_smooth()
lnPlot
```

Histogram with distribution of different gaps
```{r}
plotHist = ggplot(data = prime, aes(prime$PrimeGap)) +
  geom_bar(fill="white", colour="black") + 
      labs(x = "Prime Number Gap Value", y = "Number of Primes with the same Gap") +
  geom_vline(aes(xintercept = meanE, colour = "mean")) + 
  geom_vline(aes(xintercept = (meanE + std), colour = "std"), linetype = "dashed") + 
  geom_vline(aes(xintercept = (meanE - std), colour = "std"), linetype = "dashed") + 
  geom_vline(aes(xintercept = median(prime$PrimeGap), 
                 colour = "median"), linetype = "dashed") + 
  geom_vline(aes(xintercept = quantile(prime$PrimeGap, 0.25), 
                 colour = "quantile25"), linetype = "dashed") +
  geom_vline(aes(xintercept = quantile(prime$PrimeGap, 0.75), 
                 colour = "quantile75"), linetype = "dashed") +
  scale_colour_manual(name = "Legend", 
                 breaks = c("mean", "std","median", "quantile25", "quantile75"), 
                 values= c(mean = "red", std = "blue", median = "orange", 
                           quantile25 = "green", quantile75 = "yellow"))
plotHist
```


Prime Number Theorem
```{r}
plot = ggplot(data= prime, aes(1/prime$PrimeGap, prime$xOverlnx)) +
  geom_point() + labs(x = "1 / Prime Gap", y = "Input / ln(Input)") 
plot
```