---
title: "Prime Number Gap Pattern"
author: "Daniel Dos Santos Bossle, João Pedro Borges Pereira, Waqas Imtiaz"
date: "January 19, 2017"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

## Motivation

Prime numbers have been a mystery for centuries. Finding a pattern for these numbers has proven to be such a complex task, that it has become the base of nowadays cryptography. To encode the data, people use 2 very large prime numbers, multiplying each other and then executing the remaining operations necessary to encode. In order to decode, the hacker would need to find the original primes that forms the current number. However, no pattern has been found for prime numbers, making the task very difficult if the primes are relatively large. Nevertheless, a new pattern was discovered, which was shown to be related to the distribution of the differences between consecutive primes. These differences are called "prime gaps". The paper by Robert J. Lemke Oliver and Kannan Soundararajan demonstrates that the pattern is related to the Hardy-Littlewood conjecture, from 1923, which gives an approximation to that distribution.

Box Plot for Hypothesis (1)

```{r}
library(ggplot2)
library(reshape2)
library(Hmisc)
load(file="data/primeNumber.Rdata")
primeAux <- prime
primeAux$group <- as.numeric(cut2(primeAux$Input, g=15))
plot = ggplot(data= primeAux, aes(factor(group), prime$PrimeGap)) +
  geom_boxplot() + labs(x = "Random Number", y = "Prime Number Gap") 
plot
```


Density plot of the general distribution of the gaps between the prime numbers, usefull for hypothesis (2) since we have log(Random Number)
```{r}
smoothScatter(log(prime$Input),prime$PrimeGap,
             xlab="log(Random Number)",ylab="Prime Number Gap",main="Prime Number Gap Density")
```

```{r}
meanE <- mean(prime$PrimeGap)
std <- sd(prime$PrimeGap)
meanPlot <- ggplot(data= prime, aes(prime$PrimeGap, prime$Input)) + 
  geom_point() + labs(x = "Prime Number Gap", y = "Random Number") +
  geom_vline(aes(xintercept = meanE, colour = "mean")) + 
  geom_vline(aes(xintercept = (meanE + std), colour = "std"), linetype = "dashed") + 
  geom_vline(aes(xintercept = (meanE - std), colour = "std"), linetype = "dashed") + 
  geom_vline(aes(xintercept = median(prime$PrimeGap), 
                 colour = "median"), linetype = "dashed") + 
  geom_vline(aes(xintercept = quantile(prime$PrimeGap, 0.25), 
                 colour = "quantile25"), linetype = "dashed") +
  geom_vline(aes(xintercept = quantile(prime$PrimeGap, 0.75), 
                 colour = "quantile75"), linetype = "dashed") +
  scale_colour_manual(name = "Legend", 
                      breaks = c("mean", "std","median", "quantile25", "quantile75"), 
                      values= c(mean = "red", std = "blue", median = "orange", quantile25 = "green", quantile75 = "yellow"))
meanPlot
```

Pseudo-random distribution log(n) for hypothesis Random Number (2)
```{r}
lnPlot <- ggplot(data= prime, aes(log(prime$Input), prime$PrimeGap)) + 
  geom_point() + labs(x = "ln(Input)", y = "Prime Number Gap") + geom_smooth(method = "lm")
lnPlot
```

Pseudo-random distribution log(n) for hypothesis Random Number (2) (but with NextGap here and not PrimeGap)
```{r}
lnPlot <- ggplot(data= prime, aes(log(prime$Input), prime$NextGap)) + 
  geom_point() + labs(x = "ln(Input)", y = "Prime Number Gap") + geom_smooth(method = "lm")
lnPlot
```

Prime Number Theorem
```{r}
meanE <- mean(prime$PrimeGap)
plot = ggplot(data= prime, aes(prime$ln2x/(prime$lnx - 1), prime$PrimeGap)) +
  geom_point() + labs(x = "ln2(Prime) / (ln(Prime) -1)", y = "Prime Gap") + 
  geom_smooth(aes(colour ="Smoothed conditional mean")) +
  stat_function(fun = function(x)(x), aes(colour="y = x")) +
  scale_colour_manual(name="Legend", values=c("blue", "red"))
plot
```

Box Plot of overall average gap values
```{r}
plot = ggplot(data= prime, aes(prime$Input, prime$PrimeGap)) +
  geom_boxplot() + labs(x = "Random Number", y = "Prime Number Gap") 
plot
```

Scatter Plot of correlation between consecutive gaps, for Hypothesis (3) (As the graph show not much correlation)
```{r}
lnPlot <- ggplot(data= prime, aes(prime$PrimeGap, prime$NextGap)) + 
  geom_point() + labs(x = "Current Gap", y = "Next Gap") + geom_smooth()
lnPlot
```

Histogram with distribution of different gaps
```{r}
meanE <- mean(prime$PrimeGap)
std <- sd(prime$PrimeGap)
plotHist = ggplot(data = prime, aes(prime$PrimeGap)) +
  geom_bar(fill="white", colour="black") + 
      labs(x = "Prime Number Gap Value", y = "Number of Primes with the same Gap") +
  geom_vline(aes(xintercept = meanE, colour = "mean")) + 
  geom_vline(aes(xintercept = (meanE + std), colour = "std"), linetype = "dashed") + 
  geom_vline(aes(xintercept = (meanE - std), colour = "std"), linetype = "dashed") + 
  geom_vline(aes(xintercept = median(prime$PrimeGap), 
                 colour = "median"), linetype = "dashed") + 
  geom_vline(aes(xintercept = quantile(prime$PrimeGap, 0.25), 
                 colour = "quantile25"), linetype = "dashed") +
  geom_vline(aes(xintercept = quantile(prime$PrimeGap, 0.75), 
                 colour = "quantile75"), linetype = "dashed") +
  scale_colour_manual(name = "Legend", 
                 breaks = c("mean", "std","median", "quantile25", "quantile75"), 
                 values= c(mean = "red", std = "blue", median = "orange", 
                           quantile25 = "green", quantile75 = "yellow"))
plotHist
```

Group 1
```{r}
primeAux <- prime
primeAux$group <- as.numeric(cut2(primeAux$Input, g=15))
primeAuxHist <- subset(primeAux, primeAux$group == 1)
meanE <- mean(primeAuxHist$PrimeGap)
std <- sd(primeAuxHist$PrimeGap)
plotHist = ggplot(data = primeAuxHist, aes(primeAuxHist$PrimeGap)) +
  geom_bar(fill="white", colour="black") + 
      labs(x = "Prime Number Gap Value", y = "Number of Primes with the same Gap") +
  geom_vline(aes(xintercept = meanE, colour = "mean")) + 
  geom_vline(aes(xintercept = (meanE + std), colour = "std"), linetype = "dashed") + 
  geom_vline(aes(xintercept = (meanE - std), colour = "std"), linetype = "dashed") + 
  geom_vline(aes(xintercept = median(primeAuxHist$PrimeGap), 
                 colour = "median"), linetype = "dashed") + 
  geom_vline(aes(xintercept = quantile(primeAuxHist$PrimeGap, 0.25), 
                 colour = "quantile25"), linetype = "dashed") +
  geom_vline(aes(xintercept = quantile(primeAuxHist$PrimeGap, 0.75), 
                 colour = "quantile75"), linetype = "dashed") +
  scale_colour_manual(name = "Legend", 
                 breaks = c("mean", "std","median", "quantile25", "quantile75"), 
                 values= c(mean = "red", std = "blue", median = "orange", 
                           quantile25 = "green", quantile75 = "yellow"))
plotHist
```

Group 2
```{r, echo=FALSE}
primeAux <- prime
primeAux$group <- as.numeric(cut2(primeAux$Input, g=15))
primeAuxHist <- subset(primeAux, primeAux$group == 2)
meanE <- mean(primeAuxHist$PrimeGap)
std <- sd(primeAuxHist$PrimeGap)
plotHist = ggplot(data = primeAuxHist, aes(primeAuxHist$PrimeGap)) +
  geom_bar(fill="white", colour="black") + 
      labs(x = "Prime Number Gap Value", y = "Number of Primes with the same Gap") +
  geom_vline(aes(xintercept = meanE, colour = "mean")) + 
  geom_vline(aes(xintercept = (meanE + std), colour = "std"), linetype = "dashed") + 
  geom_vline(aes(xintercept = (meanE - std), colour = "std"), linetype = "dashed") + 
  geom_vline(aes(xintercept = median(primeAuxHist$PrimeGap), 
                 colour = "median"), linetype = "dashed") + 
  geom_vline(aes(xintercept = quantile(primeAuxHist$PrimeGap, 0.25), 
                 colour = "quantile25"), linetype = "dashed") +
  geom_vline(aes(xintercept = quantile(primeAuxHist$PrimeGap, 0.75), 
                 colour = "quantile75"), linetype = "dashed") +
  scale_colour_manual(name = "Legend", 
                 breaks = c("mean", "std","median", "quantile25", "quantile75"), 
                 values= c(mean = "red", std = "blue", median = "orange", 
                           quantile25 = "green", quantile75 = "yellow"))
plotHist
```

Group 6
```{r, echo=FALSE}
primeAux <- prime
primeAux$group <- as.numeric(cut2(primeAux$Input, g=15))
primeAuxHist <- subset(primeAux, primeAux$group == 6)
meanE <- mean(primeAuxHist$PrimeGap)
std <- sd(primeAuxHist$PrimeGap)
plotHist = ggplot(data = primeAuxHist, aes(primeAuxHist$PrimeGap)) +
  geom_bar(fill="white", colour="black") + 
      labs(x = "Prime Number Gap Value", y = "Number of Primes with the same Gap") +
  geom_vline(aes(xintercept = meanE, colour = "mean")) + 
  geom_vline(aes(xintercept = (meanE + std), colour = "std"), linetype = "dashed") + 
  geom_vline(aes(xintercept = (meanE - std), colour = "std"), linetype = "dashed") + 
  geom_vline(aes(xintercept = median(primeAuxHist$PrimeGap), 
                 colour = "median"), linetype = "dashed") + 
  geom_vline(aes(xintercept = quantile(primeAuxHist$PrimeGap, 0.25), 
                 colour = "quantile25"), linetype = "dashed") +
  geom_vline(aes(xintercept = quantile(primeAuxHist$PrimeGap, 0.75), 
                 colour = "quantile75"), linetype = "dashed") +
  scale_colour_manual(name = "Legend", 
                 breaks = c("mean", "std","median", "quantile25", "quantile75"), 
                 values= c(mean = "red", std = "blue", median = "orange", 
                           quantile25 = "green", quantile75 = "yellow"))
plotHist
```

Group 10
```{r, echo=FALSE}
primeAux <- prime
primeAux$group <- as.numeric(cut2(primeAux$Input, g=15))
primeAuxHist <- subset(primeAux, primeAux$group == 10)
meanE <- mean(primeAuxHist$PrimeGap)
std <- sd(primeAuxHist$PrimeGap)
plotHist = ggplot(data = primeAuxHist, aes(primeAuxHist$PrimeGap)) +
  geom_bar(fill="white", colour="black") + 
      labs(x = "Prime Number Gap Value", y = "Number of Primes with the same Gap") +
  geom_vline(aes(xintercept = meanE, colour = "mean")) + 
  geom_vline(aes(xintercept = (meanE + std), colour = "std"), linetype = "dashed") + 
  geom_vline(aes(xintercept = (meanE - std), colour = "std"), linetype = "dashed") + 
  geom_vline(aes(xintercept = median(primeAuxHist$PrimeGap), 
                 colour = "median"), linetype = "dashed") + 
  geom_vline(aes(xintercept = quantile(primeAuxHist$PrimeGap, 0.25), 
                 colour = "quantile25"), linetype = "dashed") +
  geom_vline(aes(xintercept = quantile(primeAuxHist$PrimeGap, 0.75), 
                 colour = "quantile75"), linetype = "dashed") +
  scale_colour_manual(name = "Legend", 
                 breaks = c("mean", "std","median", "quantile25", "quantile75"), 
                 values= c(mean = "red", std = "blue", median = "orange", 
                           quantile25 = "green", quantile75 = "yellow"))
plotHist
```

Group 15
```{r, echo=FALSE}
primeAux <- prime
primeAux$group <- as.numeric(cut2(primeAux$Input, g=15))
primeAuxHist <- subset(primeAux, primeAux$group == 15)
meanE <- mean(primeAuxHist$PrimeGap)
std <- sd(primeAuxHist$PrimeGap)
plotHist = ggplot(data = primeAuxHist, aes(primeAuxHist$PrimeGap)) +
  geom_bar(fill="white", colour="black") + 
      labs(x = "Prime Number Gap Value", y = "Number of Primes with the same Gap") +
  geom_vline(aes(xintercept = meanE, colour = "mean")) + 
  geom_vline(aes(xintercept = (meanE + std), colour = "std"), linetype = "dashed") + 
  geom_vline(aes(xintercept = (meanE - std), colour = "std"), linetype = "dashed") + 
  geom_vline(aes(xintercept = median(primeAuxHist$PrimeGap), 
                 colour = "median"), linetype = "dashed") + 
  geom_vline(aes(xintercept = quantile(primeAuxHist$PrimeGap, 0.25), 
                 colour = "quantile25"), linetype = "dashed") +
  geom_vline(aes(xintercept = quantile(primeAuxHist$PrimeGap, 0.75), 
                 colour = "quantile75"), linetype = "dashed") +
  scale_colour_manual(name = "Legend", 
                 breaks = c("mean", "std","median", "quantile25", "quantile75"), 
                 values= c(mean = "red", std = "blue", median = "orange", 
                           quantile25 = "green", quantile75 = "yellow"))
plotHist
```

Evolution of a certain gap overtime (In this case the gap of value 2)

```{r}
primeAux <- prime
primeAux$group <- as.numeric(cut2(primeAux$Input, g=15))
primeAux$groupGap <- as.numeric(cut2(primeAux$PrimeGap))
primeAuxHist <- subset(primeAux, primeAux$groupGap == 1)
plotHist = ggplot(data = primeAuxHist, aes(factor(primeAuxHist$group))) +
  geom_bar(fill="white", colour="black") + 
      labs(x = "Input group", y = "Count numbers with the gap of the corresponding group") 
plotHist
```
